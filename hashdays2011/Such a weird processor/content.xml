<?xml version="1.0" encoding="UTF-8"?>
<office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:presentation="urn:oasis:names:tc:opendocument:xmlns:presentation:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:smil="urn:oasis:names:tc:opendocument:xmlns:smil-compatible:1.0" xmlns:anim="urn:oasis:names:tc:opendocument:xmlns:animation:1.0" xmlns:rpt="http://openoffice.org/2005/report" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:grddl="http://www.w3.org/2003/g/data-view#" xmlns:officeooo="http://openoffice.org/2009/office" xmlns:tableooo="http://openoffice.org/2009/table" xmlns:drawooo="http://openoffice.org/2010/draw" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" office:version="1.2" grddl:transformation="http://docs.oasis-open.org/office/1.2/xslt/odf2rdf.xsl"><office:scripts/><office:automatic-styles><style:style style:name="dp1" style:family="drawing-page"><style:drawing-page-properties presentation:background-visible="true" presentation:background-objects-visible="true" presentation:display-footer="true" presentation:display-page-number="false" presentation:display-date-time="true"/></style:style><style:style style:name="dp2" style:family="drawing-page"><style:drawing-page-properties presentation:display-header="true" presentation:display-footer="true" presentation:display-page-number="false" presentation:display-date-time="true"/></style:style><style:style style:name="dp3" style:family="drawing-page"><style:drawing-page-properties presentation:visibility="hidden" presentation:background-visible="true" presentation:background-objects-visible="true" presentation:display-footer="true" presentation:display-page-number="false" presentation:display-date-time="true"/></style:style><style:style style:name="gr1" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr2" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" svg:stroke-color="#000000" draw:fill="none" draw:fill-color="#ffffff" draw:textarea-horizontal-align="left" draw:auto-grow-height="true" draw:auto-grow-width="true" fo:min-height="0cm" fo:min-width="0cm"/></style:style><style:style style:name="gr3" style:family="graphic"><style:graphic-properties style:protect="size"/></style:style><style:style style:name="gr4" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Fine_20_Dotted" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="gr5" style:family="graphic" style:parent-style-name="arrow"><style:graphic-properties draw:fill="solid" draw:fill-color="#0047ff"/></style:style><style:style style:name="gr6" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.102cm" svg:stroke-color="#800000" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr7" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Ultrafine_20_Dashed" svg:stroke-width="0.102cm" svg:stroke-color="#808000" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr8" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Fine_20_Dashed" svg:stroke-width="0.102cm" svg:stroke-color="#0000ff" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr9" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="dash" draw:stroke-dash="Fine_20_Dashed_20__28_var_29_" svg:stroke-width="0.102cm" svg:stroke-color="#333333" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr10" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="solid" svg:stroke-width="0.102cm" svg:stroke-color="#800000" draw:marker-start-width="0.353cm" draw:marker-end-width="0.353cm" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" fo:padding-top="0.15cm" fo:padding-bottom="0.15cm" fo:padding-left="0.275cm" fo:padding-right="0.275cm"/></style:style><style:style style:name="gr11" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:fill="solid" draw:fill-color="#0047ff" draw:textarea-horizontal-align="justify" draw:textarea-vertical-align="middle" draw:auto-grow-height="false"/></style:style><style:style style:name="gr12" style:family="graphic" style:parent-style-name="standard"><style:graphic-properties draw:stroke="none" draw:fill="none" draw:textarea-horizontal-align="center" draw:textarea-vertical-align="middle" draw:color-mode="standard" draw:luminance="0%" draw:contrast="0%" draw:gamma="100%" draw:red="0%" draw:green="0%" draw:blue="0%" fo:clip="rect(0cm, 0cm, 0cm, 0cm)" draw:image-opacity="100%" style:mirror="none"/></style:style><style:style style:name="pr1" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties fo:min-height="3.005cm"/></style:style><style:style style:name="pr2" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="4.661cm"/></style:style><style:style style:name="pr3" style:family="presentation" style:parent-style-name="Default-notes"><style:graphic-properties draw:fill-color="#ffffff" draw:auto-grow-height="true" fo:min-height="12.572cm"/></style:style><style:style style:name="pr4" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties fo:min-height="2.755cm"/></style:style><style:style style:name="pr5" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties fo:min-height="11.629cm"/></style:style><style:style style:name="pr6" style:family="presentation" style:parent-style-name="Default-notes"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="12.322cm"/></style:style><style:style style:name="pr7" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties fo:min-height="11.879cm"/></style:style><style:style style:name="pr8" style:family="presentation" style:parent-style-name="Default-notes"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="12.572cm"/></style:style><style:style style:name="pr9" style:family="presentation" style:parent-style-name="Default-outline1" style:list-style-name="L4"><style:graphic-properties fo:min-height="11.629cm"/></style:style><style:style style:name="pr10" style:family="presentation" style:parent-style-name="Default-outline1" style:list-style-name="L5"><style:graphic-properties fo:min-height="11.879cm"/></style:style><style:style style:name="pr11" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties draw:auto-grow-height="true" fo:min-height="3.005cm"/></style:style><style:style style:name="pr12" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" fo:min-height="15.373cm"/></style:style><style:style style:name="pr13" style:family="presentation" style:parent-style-name="Default-title"><style:graphic-properties draw:auto-grow-height="true" fo:min-height="3.006cm"/></style:style><style:style style:name="pr14" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties draw:auto-grow-height="true" fo:min-height="11.879cm"/></style:style><style:style style:name="pr15" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties fo:min-height="7.62cm"/></style:style><style:style style:name="pr16" style:family="presentation" style:parent-style-name="Default-outline1"><style:graphic-properties fo:min-height="7.853cm"/></style:style><style:style style:name="pr17" style:family="presentation" style:parent-style-name="Default-subtitle"><style:graphic-properties draw:fill-color="#ffffff" draw:auto-grow-height="true" fo:min-height="15.373cm"/></style:style><style:style style:name="P1" style:family="paragraph"><style:text-properties fo:font-size="28pt" style:font-size-asian="28pt" style:font-size-complex="28pt"/></style:style><style:style style:name="P2" style:family="paragraph"><style:paragraph-properties fo:text-align="center"/></style:style><style:style style:name="P3" style:family="paragraph"><style:paragraph-properties fo:text-align="start"/></style:style><style:style style:name="P4" style:family="paragraph"><style:text-properties fo:font-size="20pt"/></style:style><style:style style:name="P5" style:family="paragraph"><style:text-properties fo:font-size="14pt" style:font-size-asian="14pt" style:font-size-complex="14pt"/></style:style><style:style style:name="P6" style:family="paragraph"><style:text-properties fo:font-size="20pt" style:font-size-asian="20pt" style:font-size-complex="20pt"/></style:style><style:style style:name="P7" style:family="paragraph"><style:text-properties fo:font-size="16pt" style:font-size-asian="16pt" style:font-size-complex="16pt"/></style:style><style:style style:name="P8" style:family="paragraph"><style:text-properties fo:font-family="&apos;Courier New&apos;" style:font-family-generic="modern" style:font-pitch="fixed" fo:font-size="15pt" style:font-size-asian="15pt" style:font-size-complex="15pt"/></style:style><style:style style:name="P9" style:family="paragraph"><style:text-properties fo:font-style="italic" style:font-style-asian="italic" style:font-style-complex="italic"/></style:style><style:style style:name="P10" style:family="paragraph"><style:text-properties fo:font-size="26pt" style:font-size-asian="26pt" style:font-size-complex="26pt"/></style:style><style:style style:name="P11" style:family="paragraph"><style:paragraph-properties fo:text-align="end"/></style:style><style:style style:name="P12" style:family="paragraph"><style:text-properties fo:font-size="28pt"/></style:style><style:style style:name="P13" style:family="paragraph"><style:paragraph-properties fo:text-align="start"/><style:text-properties fo:font-size="18pt"/></style:style><style:style style:name="T1" style:family="text"><style:text-properties fo:font-size="48pt" style:font-size-asian="48pt" style:font-size-complex="48pt"/></style:style><style:style style:name="T2" style:family="text"><style:text-properties fo:font-size="36pt" style:font-size-asian="36pt" style:font-size-complex="36pt"/></style:style><style:style style:name="T3" style:family="text"><style:text-properties fo:font-size="24pt" style:font-size-asian="24pt" style:font-size-complex="24pt"/></style:style><style:style style:name="T4" style:family="text"><style:text-properties fo:font-size="28pt" style:font-size-asian="28pt" style:font-size-complex="28pt"/></style:style><style:style style:name="T5" style:family="text"><style:text-properties style:text-position="super 58%" fo:font-size="28pt" style:font-size-asian="28pt" style:font-size-complex="28pt"/></style:style><style:style style:name="T6" style:family="text"><style:text-properties fo:color="#00b8ff" fo:font-size="15pt" fo:font-weight="bold" style:font-size-asian="15pt" style:font-weight-asian="bold" style:font-size-complex="15pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T7" style:family="text"><style:text-properties fo:color="#000000" fo:font-size="15pt" fo:font-weight="bold" style:font-size-asian="15pt" style:font-weight-asian="bold" style:font-size-complex="15pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T8" style:family="text"><style:text-properties fo:font-size="20pt" style:font-size-asian="20pt" style:font-size-complex="20pt"/></style:style><style:style style:name="T9" style:family="text"><style:text-properties fo:font-size="20pt"/></style:style><style:style style:name="T10" style:family="text"><style:text-properties fo:font-size="54pt" style:font-size-asian="54pt" style:font-size-complex="54pt"/></style:style><style:style style:name="T11" style:family="text"><style:text-properties fo:font-size="16pt" style:font-size-asian="16pt" style:font-size-complex="16pt"/></style:style><style:style style:name="T12" style:family="text"><style:text-properties fo:font-family="&apos;Courier New&apos;" style:font-family-generic="modern" style:font-pitch="fixed" fo:font-size="15pt" style:font-size-asian="15pt" style:font-size-complex="15pt"/></style:style><style:style style:name="T13" style:family="text"><style:text-properties fo:font-family="&apos;Courier New&apos;" style:font-family-generic="modern" style:font-pitch="fixed" fo:font-size="10pt" style:font-size-asian="10pt" style:font-size-complex="10pt"/></style:style><style:style style:name="T14" style:family="text"><style:text-properties fo:font-style="italic" style:font-style-asian="italic" style:font-style-complex="italic"/></style:style><style:style style:name="T15" style:family="text"><style:text-properties fo:font-size="26pt" style:font-size-asian="26pt" style:font-size-complex="26pt"/></style:style><style:style style:name="T16" style:family="text"><style:text-properties fo:font-size="26pt" fo:font-style="italic" style:font-size-asian="26pt" style:font-style-asian="italic" style:font-size-complex="26pt" style:font-style-complex="italic"/></style:style><style:style style:name="T17" style:family="text"><style:text-properties fo:font-style="normal" style:font-style-asian="normal" style:font-style-complex="normal"/></style:style><style:style style:name="T18" style:family="text"><style:text-properties fo:font-weight="bold"/></style:style><style:style style:name="T19" style:family="text"><style:text-properties fo:color="#000000" fo:font-family="&apos;Courier New&apos;" style:font-family-generic="modern" style:font-pitch="fixed" fo:font-size="22pt" fo:font-weight="bold" style:font-size-asian="22pt" style:font-weight-asian="bold" style:font-size-complex="22pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T20" style:family="text"><style:text-properties fo:color="#ff0000" fo:font-family="&apos;Courier New&apos;" style:font-family-generic="modern" style:font-pitch="fixed" fo:font-size="22pt" fo:font-weight="bold" style:font-size-asian="22pt" style:font-weight-asian="bold" style:font-size-complex="22pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T21" style:family="text"><style:text-properties fo:font-family="&apos;Courier New&apos;" style:font-family-generic="modern" style:font-pitch="fixed" fo:font-size="22pt" fo:font-weight="bold" style:font-size-asian="22pt" style:font-weight-asian="bold" style:font-size-complex="22pt" style:font-weight-complex="bold"/></style:style><style:style style:name="T22" style:family="text"><style:text-properties fo:color="#ff0000"/></style:style><style:style style:name="T23" style:family="text"><style:text-properties fo:color="#000000"/></style:style><style:style style:name="T24" style:family="text"><style:text-properties style:text-underline-style="solid" style:text-underline-width="auto" style:text-underline-color="font-color"/></style:style><style:style style:name="T25" style:family="text"><style:text-properties fo:font-size="44pt" style:font-size-asian="44pt" style:font-size-complex="44pt"/></style:style><style:style style:name="T26" style:family="text"><style:text-properties fo:font-size="18pt" style:font-size-asian="18pt" style:font-size-complex="18pt"/></style:style><style:style style:name="T27" style:family="text"><style:text-properties fo:font-size="72pt" style:font-size-asian="72pt" style:font-size-complex="72pt"/></style:style><text:list-style style:name="L1"><text:list-level-style-bullet text:level="1" text:bullet-char="●"><style:list-level-properties/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="2" text:bullet-char="●"><style:list-level-properties text:space-before="0.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="3" text:bullet-char="●"><style:list-level-properties text:space-before="1.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="4" text:bullet-char="●"><style:list-level-properties text:space-before="1.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="5" text:bullet-char="●"><style:list-level-properties text:space-before="2.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="6" text:bullet-char="●"><style:list-level-properties text:space-before="3cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="7" text:bullet-char="●"><style:list-level-properties text:space-before="3.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="8" text:bullet-char="●"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="9" text:bullet-char="●"><style:list-level-properties text:space-before="4.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="10" text:bullet-char="●"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet></text:list-style><text:list-style style:name="L2"><text:list-level-style-bullet text:level="1" text:bullet-char="●"><style:list-level-properties/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="2" text:bullet-char="●"><style:list-level-properties text:space-before="0.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="3" text:bullet-char="●"><style:list-level-properties text:space-before="1.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="4" text:bullet-char="●"><style:list-level-properties text:space-before="1.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="5" text:bullet-char="●"><style:list-level-properties text:space-before="2.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="6" text:bullet-char="●"><style:list-level-properties text:space-before="3cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="7" text:bullet-char="●"><style:list-level-properties text:space-before="3.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="8" text:bullet-char="●"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="9" text:bullet-char="●"><style:list-level-properties text:space-before="4.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="10" text:bullet-char="●"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet></text:list-style><text:list-style style:name="L3"><text:list-level-style-bullet text:level="1" text:bullet-char="●"><style:list-level-properties text:space-before="0.3cm" text:min-label-width="0.9cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="2" text:bullet-char="●"><style:list-level-properties text:space-before="1.5cm" text:min-label-width="0.9cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="3" text:bullet-char="–"><style:list-level-properties text:space-before="2.8cm" text:min-label-width="0.8cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="75%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="4" text:bullet-char="●"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="5" text:bullet-char="–"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="75%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="6" text:bullet-char="●"><style:list-level-properties text:space-before="6.6cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="7" text:bullet-char="●"><style:list-level-properties text:space-before="7.8cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="8" text:bullet-char="●"><style:list-level-properties text:space-before="9cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="9" text:bullet-char="●"><style:list-level-properties text:space-before="10.2cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet><text:list-level-style-bullet text:level="10" text:bullet-char="●"><style:list-level-properties text:space-before="11.4cm" text:min-label-width="0.6cm"/><style:text-properties fo:font-family="StarSymbol" style:use-window-font-color="true" fo:font-size="45%"/></text:list-level-style-bullet></text:list-style><text:list-style style:name="L4"><text:list-level-style-number text:level="1" style:num-suffix="." style:num-format="1" text:start-value="0"><style:list-level-properties/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="2" style:num-suffix="." style:num-format="1" text:start-value="0"><style:list-level-properties text:space-before="0.6cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="3" style:num-suffix="." style:num-format="1" text:start-value="0"><style:list-level-properties text:space-before="1.2cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="4" style:num-suffix="." style:num-format="1" text:start-value="0"><style:list-level-properties text:space-before="1.8cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="5" style:num-suffix="." style:num-format="1" text:start-value="0"><style:list-level-properties text:space-before="2.4cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="6" style:num-suffix="." style:num-format="1" text:start-value="0"><style:list-level-properties text:space-before="3cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="7" style:num-suffix="." style:num-format="1" text:start-value="0"><style:list-level-properties text:space-before="3.6cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="8" style:num-suffix="." style:num-format="1" text:start-value="0"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="9" style:num-suffix="." style:num-format="1" text:start-value="0"><style:list-level-properties text:space-before="4.8cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="10" style:num-suffix="." style:num-format="1" text:start-value="0"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number></text:list-style><text:list-style style:name="L5"><text:list-level-style-number text:level="1" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="0.3cm" text:min-label-width="0.9cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="2" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="1.5cm" text:min-label-width="0.9cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="3" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="2.8cm" text:min-label-width="0.8cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="4" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="4.2cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="5" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="5.4cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="6" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="6.6cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="7" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="7.8cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="8" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="9cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="9" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="10.2cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number><text:list-level-style-number text:level="10" style:num-suffix="." style:num-format="I"><style:list-level-properties text:space-before="11.4cm" text:min-label-width="0.6cm"/><style:text-properties style:use-window-font-color="true" fo:font-size="100%"/></text:list-level-style-number></text:list-style></office:automatic-styles><office:body><office:presentation><draw:page draw:name="page1" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL1T0"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="4.259cm" svg:x="1.35cm" svg:y="5.39cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T1">Such a weird processor</text:span><text:line-break/><text:span text:style-name="T2">messing with opcodes</text:span><text:span text:style-name="T2"><text:line-break/></text:span><text:span text:style-name="T3">(...and a little bit of PE)</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr2" draw:text-style-name="P1" draw:layer="layout" svg:width="24.299cm" svg:height="4.661cm" svg:x="1.35cm" svg:y="11.43cm"><draw:text-box><text:p><text:span text:style-name="T4">Ange Albertini</text:span></text:p><text:p><text:span text:style-name="T4">28</text:span><text:span text:style-name="T5">th</text:span><text:span text:style-name="T4"> October 2011</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="9.141cm" svg:height="3.395cm" svg:x="17.846cm" svg:y="14.605cm"><draw:image xlink:href="Pictures/10000201000001A40000009C5F0B4D9D.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="3.81cm" svg:height="3.81cm" svg:x="0cm" svg:y="14.19cm"><draw:image xlink:href="Pictures/1000020100000050000000502BC44F56.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:layer="layout" svg:width="6.111cm" svg:height="1.471cm" svg:x="4.184cm" svg:y="15.699cm"><draw:text-box><text:p text:style-name="P3"><text:span text:style-name="T6">@ange4771</text:span></text:p><text:p text:style-name="P3"><text:span text:style-name="T6">@corkami</text:span><text:span text:style-name="T7"> (news only)</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="1" presentation:class="page"/><draw:frame presentation:style-name="pr3" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>Hi,</text:p><text:p/><text:p>welcome to my first public presentation ever!</text:p><text:p/><text:p>I will talk today about opcodes weirdness,</text:p><text:p>and also a little bit of PE files...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page2" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title"><draw:text-box><text:p text:style-name="P3">a presentation on...</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="24.299cm" svg:height="12.942cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>user-mode assembly tricks</text:p><text:list><text:list-item><text:p>why does it matter ?</text:p></text:list-item><text:list-item><text:p>introducing a few tricks</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>introducing an opcode tester: CoST</text:p><text:list><text:list-item><text:p>also a hardened PE</text:p><text:list><text:list-item><text:p>having failed many tools</text:p></text:list-item></text:list></text:list-item></text:list></text:list-item><text:list-item><text:p>more PE experiments</text:p><text:list><text:list-item><text:p>and more failed tools...</text:p><text:p/><text:p>recommended music for these slides: monty on the run</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:layer="layout" svg:width="6.187cm" svg:height="1.675cm" draw:transform="rotate (-0.573515192206415) translate (21.473cm 0.316cm)"><draw:text-box><text:p text:style-name="P2">HIDDEN SLIDE</text:p><text:p text:style-name="P2">FOR OFFLINE USE</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="2" presentation:class="page"/><draw:frame presentation:style-name="pr6" draw:text-style-name="P4" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p text:style-name="P4">this extra slide to let you decide if you really want to read further ;)</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page3" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p text:style-name="P3">presented by...</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>a reverse-engineering enthusiast</text:p><text:list><text:list-item><text:p><text:span text:style-name="T8">...since dos 3.21</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T8">Corkami.com</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T8">Mame</text:span></text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>a malware analyst</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="3" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>I&apos;ve been a reverse-engineering enthusiast for some time.</text:p><text:p>I created a website called Corkami</text:p><text:p>in the past, I worked on decrypted arcade games, in Mame</text:p><text:p/><text:p>and professionally, I&apos;m a malware analyst.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page4" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>Corka-what ?</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>RCE project, only technical stuff</text:p></text:list-item><text:list-item><text:p>free to:</text:p><text:list><text:list-item><text:p>browse, download</text:p></text:list-item><text:list-item><text:p>test, modify, compile</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>updated</text:p></text:list-item><text:list-item><text:p>useful daily</text:p><text:p/></text:list-item><text:list-item><text:p>but.... only a hobby !</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="4" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:text-style-name="P4" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T9">I have a hobby research project, called Corkami.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">only technical stuff</text:span></text:p><text:p><text:span text:style-name="T9">No ads, no login required, no annoying licenses,</text:span></text:p><text:p><text:span text:style-name="T9">binaries available to test and learn immediately</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">it&apos;s now a wiki, so it&apos;s constantly updated...</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">Some cheat sheets and graphs to use daily at work...</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">I&apos;m trying to make it good, but, it&apos;s only a hobby, so it&apos;s not as good as I&apos;d like it to be, and that&apos;s why it doesn&apos;t look very professional!</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page5" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title"><draw:text-box><text:p>what is in Corkami ?</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="24.299cm" svg:height="11.629cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>wiki pages, cheat sheets</text:p></text:list-item><text:list-item><text:p>many PoCs</text:p><text:list><text:list-item><text:p>hand-written (not generated), minimalists</text:p></text:list-item><text:list-item><text:p>binaries available</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>100% open</text:p><text:list><text:list-item><text:p>BSD, even graphs</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>on PDF, x86, PE,...</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="5" presentation:class="page"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>So what&apos;s there ?</text:p><text:p>some wiki pages, and some cheat sheets on particular topics, such as PDF, x86, PE.</text:p><text:p>I create by hand (with no external tool) minimalists proof of concepts to focus on specific points.</text:p><text:p>these PoCs are open-source, and compilable with free tools, under a permissive licence.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page6" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title"><draw:text-box><text:p>Story</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr9" draw:layer="layout" svg:width="24.299cm" svg:height="11.629cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L4"><text:list-item><text:p>CPU are electronic, thus perfect</text:p></text:list-item><text:list-item><text:p>tricked by a malware</text:p></text:list-item><text:list-item><text:p>back to the basics </text:p></text:list-item><text:list-item><text:p>documented on Corkami</text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T10">this presentation</text:span></text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="6" presentation:class="page"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>the motivation behind this presentation is:</text:p><text:p>long ago, I was innocent, and believed that, since CPU are made of electronic component, they should be perfectly logical.</text:p><text:p/><text:p>several years ago, I was tricked by a malware, using stuff undocumented at the time.</text:p><text:p>So I decided to go back to the basics, and study ASM and PE from scratch, and share my discoveries on the way, on Corkami.</text:p><text:p/><text:p>and I&apos;m now presenting the result.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page7" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>Agenda</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr10" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L5"><text:list-item><text:p>why does it matter ?</text:p><text:list><text:list-header><text:p>(an easy introduction)</text:p></text:list-header></text:list></text:list-item><text:list-item><text:p>a bunch of tricks </text:p></text:list-item></text:list><text:list text:style-name="L3"><text:list-item><text:list><text:list-header><text:p>(technical stuff starts now)</text:p></text:list-header></text:list></text:list-item></text:list><text:list text:style-name="L5"><text:list-item><text:p>CoST</text:p></text:list-item><text:list-item><text:p>a bit more of PE</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="7" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:text-style-name="P5" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so, first, I&apos;ll start slowly, trying to introduce assembly to beginners, and make them understand the problem of undocumented opcodes.</text:p><text:p/><text:p>then it will get more technical:</text:p><text:p>I&apos;ll cover a few assembly tricks, including some found in malware.</text:p><text:p/><text:p>then I&apos;ll introduce my opcode tester, CoST.</text:p><text:p/><text:p>and I&apos;ll also present my last project which deals with the PE format.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page8" draw:style-name="dp1" draw:master-page-name="Default"><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="12.884cm" svg:height="16.155cm" svg:x="6.985cm" svg:y="0.99cm"><draw:image xlink:href="Pictures/100000000000013F00000190FEA82CEC.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="8" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>So, let&apos;s start and try to make everybody understand the problem of undocumented opcodes.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page9" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>from C to binary</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P2" draw:layer="layout" svg:width="15.221cm" svg:height="5.715cm" svg:x="1.27cm" svg:y="3.845cm"><draw:image xlink:href="Pictures/10000000000001E2000000B583B3039F.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr4" draw:text-style-name="P2" draw:layer="layout" svg:width="8.226cm" svg:height="6.639cm" svg:x="17.145cm" svg:y="9.79cm"><draw:image xlink:href="Pictures/1000000000000137000000FBD96B3990.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:custom-shape draw:style-name="gr5" draw:layer="layout" svg:width="3.175cm" svg:height="1.27cm" draw:transform="rotate (-0.408232512042583) translate (14.866cm 8.89cm)"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:mirror-horizontal="false" draw:mirror-vertical="false" draw:text-areas="0 ?f0 ?f5 ?f2" draw:type="right-arrow" draw:modifiers="16200 5400" draw:enhanced-path="M 0 ?f0 L ?f1 ?f0 ?f1 0 21600 10800 ?f1 21600 ?f1 ?f2 0 ?f2 Z N"><draw:equation draw:name="f0" draw:formula="$1 "/><draw:equation draw:name="f1" draw:formula="$0 "/><draw:equation draw:name="f2" draw:formula="21600-$1 "/><draw:equation draw:name="f3" draw:formula="21600-?f1 "/><draw:equation draw:name="f4" draw:formula="?f3 *?f0 /10800"/><draw:equation draw:name="f5" draw:formula="?f1 +?f4 "/><draw:equation draw:name="f6" draw:formula="?f1 *?f0 /10800"/><draw:equation draw:name="f7" draw:formula="?f1 -?f6 "/><draw:handle draw:handle-position="$0 $1" draw:handle-range-x-minimum="0" draw:handle-range-x-maximum="21600" draw:handle-range-y-minimum="0" draw:handle-range-y-maximum="10800"/></draw:enhanced-geometry></draw:custom-shape><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="9" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:text-style-name="P6" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T8">so, we create a simple program in a language, such as C.</text:span></text:p><text:p><text:span text:style-name="T8"/></text:p><text:p><text:span text:style-name="T8">Here, in Visual Studio, Microsoft standard development environment.</text:span></text:p><text:p><text:span text:style-name="T8"/></text:p><text:p><text:span text:style-name="T8">this program shows a simple message box on screen, then terminates.</text:span></text:p><text:p><text:span text:style-name="T8"/></text:p><text:p><text:span text:style-name="T8">an executable is generated, and indeed does what we expected.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page10" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>inside the binary</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="24.552cm" svg:height="12.391cm" svg:x="1.27cm" svg:y="3.81cm"><draw:image xlink:href="Pictures/100000000000025700000113DEE79D48.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="10" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>what the Visual Studio compiler did from our C code is actually generate sequences of assembly code instruction (we call them &apos;opcode&apos;) that will generate the wanted actions.</text:p><text:p/></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page11" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="24.552cm" svg:height="12.391cm" svg:x="1.27cm" svg:y="3.81cm"><draw:image xlink:href="Pictures/100000000000025700000113DEE79D48.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>our code, &apos;translated&apos;</text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr6" draw:text-style-name="P2" draw:layer="layout" svg:width="3.56cm" svg:height="0.751cm" svg:x="2.221cm" svg:y="9.538cm"><text:p/></draw:rect><draw:rect draw:style-name="gr6" draw:text-style-name="P2" draw:layer="layout" svg:width="3.625cm" svg:height="0.719cm" svg:x="18.325cm" svg:y="13.163cm"><text:p/></draw:rect><draw:rect draw:style-name="gr7" draw:text-style-name="P2" draw:layer="layout" svg:width="4.541cm" svg:height="0.752cm" svg:x="6.663cm" svg:y="9.57cm"><text:p/></draw:rect><draw:rect draw:style-name="gr7" draw:text-style-name="P2" draw:layer="layout" svg:width="4.541cm" svg:height="0.752cm" svg:x="17.264cm" svg:y="11.77cm"><text:p/></draw:rect><draw:rect draw:style-name="gr8" draw:text-style-name="P2" draw:layer="layout" svg:width="2.681cm" svg:height="0.829cm" svg:x="11.43cm" svg:y="9.525cm"><text:p/></draw:rect><draw:rect draw:style-name="gr8" draw:text-style-name="P2" draw:layer="layout" svg:width="2.681cm" svg:height="0.829cm" svg:x="17.231cm" svg:y="10.926cm"><text:p/></draw:rect><draw:rect draw:style-name="gr9" draw:text-style-name="P2" draw:layer="layout" svg:width="3.561cm" svg:height="0.85cm" svg:x="2.186cm" svg:y="13.849cm"><text:p/></draw:rect><draw:rect draw:style-name="gr9" draw:text-style-name="P2" draw:layer="layout" svg:width="3.561cm" svg:height="0.85cm" svg:x="18.387cm" svg:y="15.349cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="11" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:text-style-name="P4" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">Here, you can see calls to MessageBox, then ExitProcess (the names are self-explaining), with the parameters above.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">these opcodes are stored in hexadecimal directly in the binary, as visible on the left.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page12" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="24.552cm" svg:height="12.391cm" svg:x="1.27cm" svg:y="3.81cm"><draw:image xlink:href="Pictures/100000000000025700000113DEE79D48.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>bytes &lt;=&gt; assembly</text:p></draw:text-box></draw:frame><draw:rect draw:style-name="gr6" draw:text-style-name="P2" draw:layer="layout" svg:width="0.914cm" svg:height="1.436cm" svg:x="3.691cm" svg:y="11.041cm"><text:p/></draw:rect><draw:rect draw:style-name="gr6" draw:text-style-name="P2" draw:layer="layout" svg:width="1.469cm" svg:height="1.307cm" svg:x="9.767cm" svg:y="11.138cm"><text:p/></draw:rect><draw:rect draw:style-name="gr7" draw:text-style-name="P2" draw:layer="layout" svg:width="3.406cm" svg:height="0.752cm" svg:x="4.662cm" svg:y="11.005cm"><text:p/></draw:rect><draw:rect draw:style-name="gr7" draw:text-style-name="P2" draw:layer="layout" svg:width="2.692cm" svg:height="0.752cm" svg:x="19.912cm" svg:y="11.018cm"><text:p/></draw:rect><draw:rect draw:style-name="gr9" draw:text-style-name="P2" draw:layer="layout" svg:width="0.883cm" svg:height="0.686cm" svg:x="3.722cm" svg:y="13.196cm"><text:p/></draw:rect><draw:rect draw:style-name="gr9" draw:text-style-name="P2" draw:layer="layout" svg:width="1.375cm" svg:height="0.657cm" svg:x="9.829cm" svg:y="13.225cm"><text:p/></draw:rect><draw:rect draw:style-name="gr9" draw:text-style-name="P2" draw:layer="layout" svg:width="0.883cm" svg:height="0.686cm" svg:x="3.723cm" svg:y="15.396cm"><text:p/></draw:rect><draw:rect draw:style-name="gr9" draw:text-style-name="P2" draw:layer="layout" svg:width="1.375cm" svg:height="0.657cm" svg:x="9.83cm" svg:y="15.426cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="12" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:text-style-name="P4" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">now you know that this is what is in the file itself.</text:span></text:p><text:p><text:span text:style-name="T9">this is how it&apos;s read by &apos;us&apos; (reverse engineers, malware analysts, <text:s/>exploit developers...).</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">the CPU itself only reads the hex.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">as you can see, there is a relation:</text:span></text:p><text:p><text:span text:style-name="T9">68 - in hex - is used to push offsets</text:span></text:p><text:p><text:span text:style-name="T9">calls starts with FF 15...</text:span></text:p><text:p><text:span text:style-name="T9">and you can see the used addresses here (read them backward).</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">so, you see the first byte determine the actual opcode.</text:span></text:p><text:p><text:span text:style-name="T9">and depending on each opcode, the length is variable.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page13" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="24.552cm" svg:height="12.391cm" svg:x="0.213cm" svg:y="-0.961cm"><draw:image xlink:href="Pictures/100000000000025700000113DEE79D48.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="16.642cm" svg:height="16.73cm" svg:x="9.393cm" svg:y="0.635cm"><draw:image xlink:href="Pictures/10000000000002380000023B235318EB.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="highlight" draw:layer="layout" svg:width="5.201cm" svg:height="3.562cm" svg:x="2.704cm" svg:y="5.551cm"><text:p/></draw:rect><draw:rect draw:style-name="highlight" draw:layer="layout" svg:width="5.201cm" svg:height="1.502cm" svg:x="2.705cm" svg:y="9.928cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="13" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>This is what is actually in the file on the hard disk (the &apos;hex&apos;).</text:p><text:p/><text:p>If you&apos;d accidentally open the file in, say notepad - it doesn&apos;t really make sense, but at least you have that on your machine - you could find it here (remember, it&apos;s hex).</text:p><text:p/><text:p>Note that it&apos;s actually a very tiny part of the whole file <text:s/>(&lt;30bytes out of 56000).</text:p><text:p/><text:p/></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page14" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>Assembly</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>generated by the compiler</text:p></text:list-item><text:list-item><text:p>read directly by the CPU</text:p></text:list-item><text:list-item><text:p>the only information in a standard binary</text:p><text:list><text:list-item><text:p>what &apos;we&apos; (analysts, hackers...) read</text:p></text:list-item></text:list><text:p/></text:list-item><text:list-item><text:p>disassembly is only for humans</text:p><text:list><text:list-item><text:p>no text in the final binary</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="6.772cm" svg:height="5.08cm" svg:x="17.993cm" svg:y="11.43cm"><draw:image xlink:href="Pictures/100000000000012C000000E1FF01AD4A.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="14" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>so, the compiler translates our C to a series of assembly opcodes, which is itself encoded in hex.</text:p><text:p>the resulting executable only contains this Hex. this hex is directly understood and executed by the CPU. If no error happens, what is here directly affects the behavior of the program, there is <text:s/>no &apos;man in the middle&apos; from the OS.</text:p><text:p/><text:p>so our C code will just eventually lead the CPU to read and execute</text:p><text:p>6A 40 68 F4 20 40 00 68 FC 20...</text:p><text:p/><text:p>if, by any chance, there is some hex that we are not aware, or doesn&apos;t do what we expect, the CPU doesn&apos;t care.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page15" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL4T32"><draw:frame presentation:style-name="pr12" draw:layer="layout" svg:width="24.299cm" svg:height="15.373cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="subtitle"><draw:text-box><text:p>let&apos;s mess a bit now...</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="15" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so now, let&apos;s interfere with the compiling process</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page16" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><draw:frame presentation:style-name="pr4" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title"><draw:text-box><text:p>let&apos;s insert &apos;something&apos;</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="19.378cm" svg:height="3.57cm" svg:x="1.486cm" svg:y="4.685cm"><draw:image xlink:href="Pictures/10000000000001D80000005761D1D508.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="19.87cm" svg:height="5.316cm" svg:x="6.8cm" svg:y="12.065cm"><draw:image xlink:href="Pictures/10000000000001E2000000819B9EA1B3.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr10" draw:text-style-name="P2" draw:layer="layout" svg:width="14.605cm" svg:height="1.727cm" svg:x="6.35cm" svg:y="11.772cm"><text:p/></draw:rect><draw:rect draw:style-name="gr10" draw:text-style-name="P2" draw:layer="layout" svg:width="5.654cm" svg:height="0.948cm" svg:x="2.601cm" svg:y="5.302cm"><text:p/></draw:rect><draw:custom-shape draw:style-name="gr11" draw:text-style-name="P2" draw:layer="layout" svg:width="5.857cm" svg:height="1.905cm" draw:transform="rotate (-0.778940445166109) translate (8.532cm 6.35cm)"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:text-areas="0 ?f0 ?f5 ?f2" draw:type="right-arrow" draw:modifiers="16200 5400" draw:enhanced-path="M 0 ?f0 L ?f1 ?f0 ?f1 0 21600 10800 ?f1 21600 ?f1 ?f2 0 ?f2 Z N"><draw:equation draw:name="f0" draw:formula="$1 "/><draw:equation draw:name="f1" draw:formula="$0 "/><draw:equation draw:name="f2" draw:formula="21600-$1 "/><draw:equation draw:name="f3" draw:formula="21600-?f1 "/><draw:equation draw:name="f4" draw:formula="?f3 *?f0 /10800"/><draw:equation draw:name="f5" draw:formula="?f1 +?f4 "/><draw:equation draw:name="f6" draw:formula="?f1 *?f0 /10800"/><draw:equation draw:name="f7" draw:formula="?f1 -?f6 "/><draw:handle draw:handle-position="$0 $1" draw:handle-range-x-minimum="0" draw:handle-range-x-maximum="21600" draw:handle-range-y-minimum="0" draw:handle-range-y-maximum="10800"/></draw:enhanced-geometry></draw:custom-shape><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="16" presentation:class="page"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>let&apos;s add a command that will force a specific byte in the hex code.</text:p><text:p/><text:p>this result is not known to visual studio, which only shows ??</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page17" draw:style-name="dp1" draw:master-page-name="Default"><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="16.702cm" svg:height="17.999cm" svg:x="5.149cm" svg:y="0cm"><draw:image xlink:href="Pictures/100000000000032C0000036B156021FA.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:rect draw:style-name="gr6" draw:text-style-name="P2" draw:layer="layout" svg:width="2.159cm" svg:height="1.611cm" svg:x="17.145cm" svg:y="13.97cm"><text:p/></draw:rect><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="17" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>indeed, if we check Intel official documentation, there is nothing to see here...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page18" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>What did we do?</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.351cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>Inserting an unrecognized byte</text:p><text:list><text:list-item><text:p>directly in the binary</text:p></text:list-item><text:list-item><text:p>not even documented nor identified !!</text:p><text:p/></text:list-item></text:list></text:list-item></text:list><text:p text:style-name="P2"/><text:p text:style-name="P2">it could only crash...</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="18" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so, we forced something that is not recognized by the most expensive Microsoft compiler to execute, which is not even in Intel&apos;s books.</text:p><text:p/><text:p>We should only expect a crash, right ?</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page19" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>the CPU doesn&apos;t care</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="22.043cm" svg:height="7.783cm" svg:x="2.479cm" svg:y="5.552cm"><draw:image xlink:href="Pictures/10000000000000B800000041DD6DF34A.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="19" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:text-style-name="P7" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T11">but the CPU doesn&apos;t care about what YOU (or VS) know, and it just executes that mysterious D6 just fine (apparently)</text:span></text:p><text:p><text:span text:style-name="T11"/></text:p><text:p><text:span text:style-name="T11">it doesn&apos;t look like a big problem, but if like Microsoft, you base your judgment on Intel&apos;s documentation, you just don&apos;t know what happens next. No automated analysis, proactive detection, etc... and you need to understand that undocumented opcode.</text:span></text:p><text:p><text:span text:style-name="T11"/></text:p><text:p><text:span text:style-name="T11">You can&apos;t even skip it:</text:span></text:p><text:p><text:span text:style-name="T11">you don&apos;t know if it will jump, do nothing, trigger an exception...</text:span></text:p><text:p><text:span text:style-name="T11">and because of variable instruction length, you can&apos;t even tell what would be the next instruction, so you can&apos;t guess easily backward from the next instruction.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page20" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr13" draw:layer="layout" svg:width="24.299cm" svg:height="3.006cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>what happened ?</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="24.299cm" svg:height="11.629cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>D6 = S[ET]ALC</text:p><text:list><text:list-item><text:p>Set AL on Carry</text:p></text:list-item><text:list-item><text:p>AL = CF ? -1 : 0</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>trivial, almost benign</text:p></text:list-item><text:list-item><text:p>not documented</text:p><text:list><text:list-item><text:p>unreliable or shameful ?</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="20" presentation:class="page"/><draw:frame presentation:style-name="pr6" draw:text-style-name="P4" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p><text:span text:style-name="T9">so what did we do in reality ?</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">D6 will be decoded as SETALC, which is quite simple.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">It doesn&apos;t interfere with the execution of this example (it could have, of course).</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">surprisingly, it&apos;s not documented by Intel, but it&apos;s documented by AMD.</text:span></text:p><text:p><text:span text:style-name="T9"/></text:p><text:p><text:span text:style-name="T9">anyone knows why ?</text:span></text:p><text:p><text:span text:style-name="T9">I&apos;d be curious to know.</text:span></text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page21" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL5T3"><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>Intel: &apos;do what I do...&apos;</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr14" draw:text-style-name="P8" draw:layer="layout" svg:width="15.16cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P2">Intel&apos;s XED</text:p><text:p><text:span text:style-name="T12">F1 <text:s text:c="14"/>int1</text:span></text:p><text:p><text:span text:style-name="T12">D6 <text:s text:c="14"/>salc</text:span></text:p><text:p><text:span text:style-name="T12">F7C890909090 <text:s text:c="4"/>test eax, 0x90909090</text:span></text:p><text:p><text:span text:style-name="T12">0F1E84C090909090 </text:span><text:span text:style-name="T13">nop dword ptr [eax+eax*8-0x6f6f6f70], eax</text:span></text:p><text:p><text:span text:style-name="T12">0F2090 <text:s text:c="10"/>mov eax, cr2</text:span></text:p><text:p><text:span text:style-name="T12">660FC8 <text:s text:c="10"/>bswap ax</text:span></text:p><text:p/></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="5.885cm" svg:height="11.879cm" svg:x="16.34cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P2">MS&apos; WinDbg</text:p><text:p><text:span text:style-name="T12">??</text:span></text:p><text:p><text:span text:style-name="T12">??</text:span></text:p><text:p><text:span text:style-name="T12">??</text:span></text:p><text:p><text:span text:style-name="T12">??</text:span></text:p><text:p><text:span text:style-name="T12">??</text:span></text:p><text:p><text:span text:style-name="T12">bswap eax</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="21" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:text-style-name="P4" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p text:style-name="P4">the funny thing is, even though Intel docs are full of holes, Intel free tools are fully aware of what to expect...</text:p><text:p text:style-name="P4"/><text:p text:style-name="P4">Sadly, Microsoft WinDbg decided to follow the official docs, which makes it a very bad tool against malware, which commonly use undocumented tricks.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page22" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>the problem</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>the CPU does its stuff</text:p><text:p/></text:list-item><text:list-item><text:p>if we/our tools don&apos;t know what&apos;s next, we&apos;re blind.</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="22" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>So, you now know that the CPU knows things that the Intel documentations omits.</text:p><text:p/><text:p>if we or our tools are not able to tell what the CPU will do, we&apos;re just blind.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page23" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL4T32"><draw:frame presentation:style-name="pr12" draw:layer="layout" svg:width="24.299cm" svg:height="15.373cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="subtitle"><draw:text-box><text:p>let&apos;s start the real stuff...</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="23" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>Now, let&apos;s start the real stuff</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page24" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL5T3"><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>a multi-generation CPU: standard...</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr15" draw:layer="layout" svg:width="4.445cm" svg:height="7.62cm" svg:x="7.35cm" svg:y="5.19cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>let&apos;s go!</text:p><text:p>you win</text:p><text:p>sandwich</text:p><text:p>hello</text:p><text:p>f*ck</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr16" draw:text-style-name="P9" draw:layer="layout" svg:width="2.54cm" svg:height="7.853cm" svg:x="16.875cm" svg:y="5.074cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P9"><text:span text:style-name="T14">push</text:span></text:p><text:p text:style-name="P9"><text:span text:style-name="T14">mov</text:span></text:p><text:p text:style-name="P9"><text:span text:style-name="T14">call</text:span></text:p><text:p text:style-name="P9"><text:span text:style-name="T14">retn</text:span></text:p><text:p text:style-name="P9"><text:span text:style-name="T14">jmp</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="24" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>Intel CPU = since the 70&apos;s.</text:p><text:p/><text:p>many generations but still backward compatible...</text:p><text:p/><text:p>like &apos;English&apos;, more or less understood.</text:p><text:p/><text:p>Here, &apos;standard language&apos;. What all generations understand.</text:p><text:p/><text:p>most people would understand...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page25" draw:style-name="dp1" draw:master-page-name="Default"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>...old-style...</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr16" draw:layer="layout" svg:width="5.587cm" svg:height="7.853cm" svg:x="7.62cm" svg:y="5.074cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>thou</text:p><text:p>porpentine</text:p><text:p>enmity</text:p><text:p>hither</text:p><text:p>unkennel</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr16" draw:text-style-name="P9" draw:layer="layout" svg:width="3.175cm" svg:height="7.853cm" svg:x="16.91cm" svg:y="5.074cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P9"><text:span text:style-name="T14">aaa</text:span></text:p><text:p text:style-name="P9"><text:span text:style-name="T14">xlat</text:span></text:p><text:p text:style-name="P9"><text:span text:style-name="T14">verr</text:span></text:p><text:p text:style-name="P9"><text:span text:style-name="T14">smsw</text:span></text:p><text:p text:style-name="P9"><text:span text:style-name="T14">lsl</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="25" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>Shakespeare English and old x86</text:p><text:p/><text:p>unknown to most people.</text:p><text:p>yet still fully working</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page26" draw:style-name="dp1" draw:master-page-name="Default"><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="24.688cm" svg:height="14.338cm" svg:x="1.156cm" svg:y="1.831cm"><draw:image xlink:href="Pictures/10000000000001100000009E6436E008.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="26" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>example: a PoC on corkami</text:p><text:p/><text:p>works on all CPU</text:p><text:p/><text:p>comfortable to read ? how old are you ?!</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page27" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL5T3"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>...newest generation</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr16" draw:layer="layout" svg:width="3.73cm" svg:height="7.853cm" svg:x="6.35cm" svg:y="5.074cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>tweet</text:p><text:p>poke</text:p><text:p>google</text:p><text:p>pwn</text:p><text:p>apps</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr16" draw:text-style-name="P9" draw:layer="layout" svg:width="7.79cm" svg:height="7.853cm" svg:x="13.8cm" svg:y="5.074cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P9"><text:span text:style-name="T14">crc32</text:span></text:p><text:p text:style-name="P9"><text:span text:style-name="T14">aesenc</text:span></text:p><text:p text:style-name="P9"><text:span text:style-name="T14">pcmpistrm</text:span></text:p><text:p text:style-name="P9"><text:span text:style-name="T14">vfmsubadd132ps</text:span></text:p><text:p text:style-name="P9"><text:span text:style-name="T14">rcpss</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P10" draw:layer="layout" svg:width="14.692cm" svg:height="1.276cm" svg:x="6.154cm" svg:y="13.912cm"><draw:text-box><text:p text:style-name="P2"><text:span text:style-name="T15">and </text:span><text:span text:style-name="T16">MOVBE</text:span><text:span text:style-name="T15">, the rejected offspring</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="27" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>new generation : english and opcodes.</text:p><text:p/><text:p>probably unknown to most people</text:p><text:p/><text:p>single opcodes for CRC, AES, string masking...</text:p><text:p/><text:p>Fused Multiply-Alternating Subtract/Add of Packed Single-Precision Floating-Point Values</text:p><text:p/><text:p>Scalar Single-Precision Floating-Point Reciprocal</text:p><text:p/><text:p>MOVBE = rejected offspring </text:p><text:p>netbook only. absent from i7</text:p><text:p>so much for backward compatibility</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page28" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>registers</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>eax = &lt;your OS generation&gt;</text:p><text:list><text:list-item><text:p>OS = Vista_or_later ? eax != 0</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>gs = &lt;number of bits&gt;</text:p><text:list><text:list-item><text:p>Win = 32b ? gs == 0 : 64b</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T17">FPU </text:span>changes FST, STx... and Mmx</text:p><text:list><text:list-item><text:p>ST0 overlaps MM7</text:p></text:list-item><text:list-item><text:p>also changes CR0, under XP</text:p></text:list-item></text:list></text:list-item></text:list><text:p text:style-name="P2"/></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="28" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>the basics of assembly are the registers...</text:p><text:p/><text:p>it&apos;s not CPU specific, but the initial values of the register on process start-up, under windows, gives a few hint that are used by malwares.</text:p><text:p/><text:p>eax can immediately tell if you&apos;re on an older OS or not.</text:p><text:p>While GS can tell you if the machine is 64b or not, even in a 32b process.</text:p><text:p/><text:p>registers are overlapping. </text:p><text:p>unlike many documentations, ST0 &lt;&gt; MM7</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page29" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:text-style-name="P9" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P9"><text:span text:style-name="T14">smsw</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>CR0 access, from user-mode</text:p><text:list><text:list-item><text:p>286 opcode</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>higher word &apos;undefined&apos;</text:p></text:list-item><text:list-item><text:p>under XP</text:p><text:list><text:list-item><text:p>influenced by FPU</text:p></text:list-item><text:list-item><text:p>eventually reverts</text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="14.01cm" svg:height="6.771cm" svg:x="11.39cm" svg:y="8.89cm"><draw:image xlink:href="Pictures/100000000000014B000000A014D7FCEE.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="29" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:text-style-name="P4" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="page30" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>GS</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>reset on thread switch (Windows 32b)</text:p></text:list-item><text:list-item><text:p>eventually reset</text:p><text:list><text:list-item><text:p><text:span text:style-name="T17">debugger stepping</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T17">wait</text:span></text:p></text:list-item><text:list-item><text:p><text:span text:style-name="T17">timings</text:span></text:p><text:p><text:span text:style-name="T17"/></text:p></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="17.017cm" svg:height="4.787cm" svg:x="7.748cm" svg:y="10.795cm"><draw:image xlink:href="Pictures/100000000000012E00000055020FEF22.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="30" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>the GS trick is similar.</text:p><text:p>on 32b of windows, GS is reset on thread switch.</text:p><text:p/><text:p>ie wait long enough, it&apos;s null, whatever the value before.</text:p><text:p/><text:p>if you just step manually, instantly lost.</text:p><text:p>after some time, </text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page31" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr4" draw:text-style-name="P9" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P9"><text:span text:style-name="T14">nop</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="24.299cm" svg:height="11.822cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p><text:span text:style-name="T14">nop</text:span> is <text:span text:style-name="T14">xchg *ax, *ax</text:span></text:p><text:list><text:list-item><text:p>but <text:span text:style-name="T14">xchg *ax, *ax</text:span> can <text:span text:style-name="T18">do</text:span> something !</text:p><text:list><text:list-header><text:p text:style-name="P3">87 c0: xchg eax, eax</text:p></text:list-header></text:list></text:list-item></text:list></text:list-item></text:list><text:p text:style-name="P11"><text:span text:style-name="T19">.. .. .. .. </text:span><text:span text:style-name="T20">01 23 45 67</text:span><text:span text:style-name="T19"> =&gt; </text:span><text:span text:style-name="T20">00 00 00 00 01 23 45 67</text:span></text:p><text:list text:continue-numbering="true" text:style-name="L3"><text:list-item><text:p><text:span text:style-name="T14">hint nop</text:span></text:p><text:list><text:list-item><text:p>partially undocumented, until 0f 1f</text:p></text:list-item><text:list-item><text:p>can trigger exception</text:p></text:list-item></text:list><text:p/><text:p/></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="31" presentation:class="page"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>nop... </text:p><text:p/></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page32" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr4" draw:text-style-name="P9" draw:layer="layout" svg:width="24.299cm" svg:height="2.755cm" svg:x="1.35cm" svg:y="0.842cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P9"><text:span text:style-name="T14">mov</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr5" draw:layer="layout" svg:width="24.299cm" svg:height="11.629cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>documented, but sometimes tricky</text:p><text:list><text:list-item><text:p><text:span text:style-name="T14">mov [cr0], eax</text:span><text:span text:style-name="T14"><text:tab/></text:span><text:span text:style-name="T14"><text:tab/></text:span><text:span text:style-name="T14">mov cr0, eax</text:span></text:p><text:list><text:list-item><text:p>mod/RM is ignored</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T14">movsxd eax, ecx</text:span><text:span text:style-name="T14"><text:tab/></text:span><text:span text:style-name="T14"><text:tab/></text:span><text:span text:style-name="T14">mov eax, ecx</text:span></text:p><text:list><text:list-item><text:p>no REX prefix</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p><text:span text:style-name="T14">mov eax, cs</text:span><text:span text:style-name="T14"><text:tab/></text:span><text:span text:style-name="T14"><text:tab/></text:span><text:span text:style-name="T14"><text:tab/></text:span><text:span text:style-name="T14">movzx eax,cs</text:span></text:p><text:list><text:list-item><text:p>&apos;undefined&apos; upper bits</text:p></text:list-item></text:list></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="32" presentation:class="page"/><draw:frame presentation:style-name="pr6" draw:layer="layout" svg:width="17.271cm" svg:height="12.322cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:placeholder="true"><draw:text-box/></draw:frame></presentation:notes></draw:page><draw:page draw:name="page33" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T14">bswap</text:span><text:tab/></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr14" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>rax</text:p><text:p text:style-name="P2"><text:span text:style-name="T20">12 34 56 78 90 ab cd ef</text:span><text:span text:style-name="T21"> =&gt; </text:span><text:span text:style-name="T20">ef cd ab 90 78 56 34 12</text:span></text:p><text:p text:style-name="P3">eax</text:p><text:p text:style-name="P2"><text:span text:style-name="T19">.. .. .. .. </text:span><text:span text:style-name="T20">01 23 45 67 </text:span><text:span text:style-name="T21">=&gt; </text:span><text:span text:style-name="T20">00 00 00 00 67 45 23 01</text:span></text:p><text:p text:style-name="P3">ax</text:p><text:p text:style-name="P2"><text:span text:style-name="T19">.. .. .. .. .. .. </text:span><text:span text:style-name="T20">01 23</text:span><text:span text:style-name="T21"> =&gt; </text:span><text:span text:style-name="T19">.. .. .. .. .. .. </text:span><text:span text:style-name="T20">00 00</text:span></text:p><text:p text:style-name="P3"><text:span text:style-name="T22"/></text:p><text:p text:style-name="P2"><text:span text:style-name="T23"/></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="33" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>Bswap... is like an administration... rules prevent it to work correctly most of the time...</text:p><text:p/><text:p>it&apos;s supposed to swap the endianness of a register.</text:p><text:p/><text:p>but most of the time, it does something unexpected.</text:p><text:p/><text:p>with a 64b register, it swaps the quadword around. good.</text:p><text:p/><text:p>with a 32b, it resets the highest dword. &apos;as usual&apos;, of course...</text:p><text:p/><text:p>and on 16b, it&apos;s &apos;undefined&apos; but it just clears the register itself...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page34" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p><text:span text:style-name="T14">push</text:span>+<text:span text:style-name="T14">ret</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="24.765cm" svg:height="6.202cm" svg:x="1.27cm" svg:y="5.715cm"><draw:image xlink:href="Pictures/100000000000020F00000084B40236DA.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="34" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>anyone knows what will happen here ?</text:p><text:p/><text:p>push, ret.</text:p><text:p>put an address on the stack, pop it and jump to it.</text:p><text:p/><text:p>no possible trick, right...</text:p><text:p/></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page35" draw:style-name="dp1" draw:master-page-name="Default"><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="26.185cm" svg:height="9.92cm" svg:x="0.485cm" svg:y="3.175cm"><draw:image xlink:href="Pictures/10000000000001E3000000B74E5E9169.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="35" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so, what happened ?</text:p><text:p>olly even auto-comments the ret!</text:p><text:p/><text:p>the 66: before the RETN makes return to IP, not EIP.</text:p><text:p/><text:p>so here we returned to 1008, not 401008.</text:p><text:p/><text:p>the other problem is that while different, there is no official name for this ret to word, &apos;small ret&apos;, &apos;ret16&apos;....</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page36" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>...and so on...</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>much more @ <text:a xlink:href="http://x86.corkami.com/">http://x86.corkami.com</text:a></text:p><text:list><text:list-item><text:p>also graphs, cheat sheet...</text:p></text:list-item></text:list><text:p/></text:list-item><text:list-item><text:p>too much theory for now...</text:p></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="36" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>I won&apos;t enumerate them all.</text:p><text:p>they&apos;re already on Corkami, with some other x86 stuff that might be useful to print.</text:p><text:p/><text:p>too much theory with no practice doesn&apos;t give good results...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page37" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL4T32"><draw:frame presentation:style-name="pr12" draw:layer="layout" svg:width="24.299cm" svg:height="15.373cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="subtitle"><draw:text-box><text:p><text:span text:style-name="T24">Co</text:span>rkami <text:span text:style-name="T24">S</text:span>tandard <text:span text:style-name="T24">T</text:span>est</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="37" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so I created CoST.</text:p><text:p/><text:p>not incredible, but not trivial neither.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page38" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>CoST</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr14" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p><text:a xlink:href="http://cost.corkami.com/">http://cost.corkami.com</text:a></text:p></text:list-item><text:list-item><text:p>testing opcodes</text:p></text:list-item><text:list-item><text:p>in a hardened PE</text:p><text:list><text:list-item><text:p>available in easy mode</text:p><text:p/></text:list-item></text:list></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="13.97cm" svg:height="8.564cm" svg:x="12.7cm" svg:y="8.645cm"><draw:image xlink:href="Pictures/10000000000001E60000012A0314162B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="38" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>an opcode tester, in a tricky PE.</text:p><text:p>available in easy mode compile (less tricky).</text:p><text:p/><text:p>just run, and it roughly displays what happened.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page39" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>more than 150 tests</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>classic, rare</text:p></text:list-item><text:list-item><text:p>jumps (JMP to IP, IRET, …)</text:p></text:list-item><text:list-item><text:p>undocumented (IceBP, SetALc...)</text:p></text:list-item><text:list-item><text:p>cpu-specific (MOVBE, POPCNT,...)</text:p></text:list-item><text:list-item><text:p>os-dependant, anti-VM/debugs</text:p></text:list-item><text:list-item><text:p>exceptions triggers, interrupts, OS bugs,...</text:p></text:list-item><text:list-item><text:p>...</text:p></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="9.549cm" svg:height="1.93cm" svg:x="16.51cm" svg:y="4.445cm"><draw:image xlink:href="Pictures/100000000000010900000031AB4BA03C.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="39" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>so, it contains a lot of various tests... (150 is the lower margin, depend how you count)</text:p><text:p/><text:p>some trivial... some less trivial.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page40" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>Nasty, but documented</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:p>exports + VEH = self commented assembly</text:p><text:p/><text:p/><text:p/><text:p>a lot of DbgOutput</text:p><text:p/></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="28.835cm" svg:height="3.175cm" svg:x="1.27cm" svg:y="5.715cm"><draw:image xlink:href="Pictures/10000000000002780000004A139D2643.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="1.269cm" svg:height="8.475cm" svg:x="23.496cm" svg:y="9.305cm"><draw:image xlink:href="Pictures/100000000000016B00000975A067F5AA.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="12.767cm" svg:height="7.124cm" svg:x="10.093cm" svg:y="9.525cm"><draw:image xlink:href="Pictures/100000000000016A000000CAD16CDB23.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="40" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>it&apos;s tricky, made in assembly, but self documented.</text:p><text:p/><text:p>a VEH to add comments and one-line printing.</text:p><text:p/><text:p>and internal exports to jump over sections of the file.</text:p><text:p/><text:p>also, lots of detailed debug output.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page41" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>32+64 = ...</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="24.97cm" svg:height="12.064cm" svg:x="1.015cm" svg:y="4.445cm"><draw:image xlink:href="Pictures/10000000000001C4000000E6CF9BBD05.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="41" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>anyone sees what this is doing ?</text:p><text:p/><text:p>executing code at push_eip...</text:p><text:p>then returning to 33:push_eip</text:p><text:p/><text:p>selector 33 = 64b code.</text:p><text:p/><text:p>so the same hex is reexecuted directly in 64b mode.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page42" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>same code, different opcodes</text:p></draw:text-box></draw:frame><draw:custom-shape draw:style-name="gr11" draw:text-style-name="P2" draw:layer="layout" svg:width="2.54cm" svg:height="3.175cm" svg:x="12.23cm" svg:y="8.255cm"><text:p/><draw:enhanced-geometry svg:viewBox="0 0 21600 21600" draw:text-areas="?f0 0 ?f2 ?f5" draw:type="down-arrow" draw:modifiers="16200 5400" draw:enhanced-path="M ?f0 0 L ?f0 ?f1 0 ?f1 10800 21600 21600 ?f1 ?f2 ?f1 ?f2 0 Z N"><draw:equation draw:name="f0" draw:formula="$1 "/><draw:equation draw:name="f1" draw:formula="$0 "/><draw:equation draw:name="f2" draw:formula="21600-$1 "/><draw:equation draw:name="f3" draw:formula="21600-?f1 "/><draw:equation draw:name="f4" draw:formula="?f3 *?f0 /10800"/><draw:equation draw:name="f5" draw:formula="?f1 +?f4 "/><draw:equation draw:name="f6" draw:formula="?f1 *?f0 /10800"/><draw:equation draw:name="f7" draw:formula="?f1 -?f6 "/><draw:handle draw:handle-position="$1 $0" draw:handle-range-x-minimum="0" draw:handle-range-x-maximum="10800" draw:handle-range-y-minimum="0" draw:handle-range-y-maximum="21600"/></draw:enhanced-geometry></draw:custom-shape><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="24.004cm" svg:height="3.588cm" svg:x="1.396cm" svg:y="4.032cm"><draw:image xlink:href="Pictures/10000000000001C100000041D7D2FB23.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="23.76cm" svg:height="2.539cm" svg:x="1.518cm" svg:y="12.065cm"><draw:image xlink:href="Pictures/10000000000001BF00000030C5765BA8.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="42" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:text-style-name="P4" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p text:style-name="P4">and this hex gives exclusive opcodes to each side...</text:p><text:p text:style-name="P4"/><text:p text:style-name="P4">works fine under a 64b OS, but Windows itself can&apos;t even debug that.</text:p><text:p text:style-name="P4"/><text:p text:style-name="P4">same EIP, same hex, twice, and different opcodes.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page43" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>CoST vs WinDbg/Hiew</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr14" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T8">WinDbg 6.12.0002.633</text:span></text:p><text:p><text:span text:style-name="T8"/></text:p><text:p><text:span text:style-name="T8"/></text:p><text:p><text:span text:style-name="T8"/></text:p><text:p><text:span text:style-name="T8"/></text:p><text:p><text:span text:style-name="T8"/></text:p><text:p><text:span text:style-name="T8">Hiew 8.15</text:span></text:p><text:p/></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="16.329cm" svg:height="3.81cm" svg:x="5.336cm" svg:y="12.7cm"><draw:image xlink:href="Pictures/10000000000001B500000066E9A803FC.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="17.747cm" svg:height="5.502cm" svg:x="4.627cm" svg:y="5.293cm"><draw:image xlink:href="Pictures/1000000000000176000000745C6C70A9.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="43" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>as you&apos;d expect, WinDbg, following Intel docs too closely, will give you &apos;??&apos;</text:p><text:p/><text:p>Hiew does that too a little.</text:p><text:p/><text:p>but honestly, I found bugs in all disassemblers I looked at, no exception AFAIR. Even a crash in XED.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page44" draw:style-name="dp3" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>CoST vs Dumpbin</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="12.636cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:p>Microsoft (R) COFF/PE Dumper Version 10.00.30319.01</text:p><text:p>Copyright (C) Microsoft Corporation. <text:s/>All rights reserved.</text:p><text:p/><text:p>Dump of file CoST.exe</text:p><text:p/><text:p>File Type: EXECUTABLE IMAGE</text:p><text:p>LINK : fatal error LNK1248: image size (9B097F81) exceeds maximum allowable size (80000000)</text:p><text:p/></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:layer="layout" svg:width="6.187cm" svg:height="1.675cm" draw:transform="rotate (-0.573515192206415) translate (22.108cm 0cm)"><draw:text-box><text:p text:style-name="P2">HIDDEN SLIDE</text:p><text:p text:style-name="P2">FOR OFFLINE USE</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="44" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>Cost vs MS&apos;s standard analysis tool...</text:p><text:p/><text:p>what did you expect ?</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page45" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>a hardened PE</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="5.475cm" svg:height="9.364cm" svg:x="5.32cm" svg:y="5.08cm"><draw:image xlink:href="Pictures/10000000000000CF00000162C9D664BA.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="5.131cm" svg:height="9.279cm" svg:x="14.554cm" svg:y="5.08cm"><draw:image xlink:href="Pictures/100000000000009200000108C3E314D4.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:layer="layout" svg:width="1.526cm" svg:height="0.963cm" svg:x="7.35cm" svg:y="14.912cm"><draw:text-box><text:p>Top</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr2" draw:layer="layout" svg:width="3.393cm" svg:height="0.963cm" svg:x="15.24cm" svg:y="14.912cm"><draw:text-box><text:p>PE &apos;footer&apos;</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="45" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>CoST was originally only an opcode tester.</text:p><text:p/><text:p>then I added a few PE tricks...</text:p><text:p/><text:p>have a look yourself, the top of the file, and the PE header (right at the bottom)</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page46" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>CoST vs IDA 6.1</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="23.498cm" svg:height="8.255cm" svg:x="1.902cm" svg:y="5.08cm"><draw:image xlink:href="Pictures/100000000000017200000082FEA0CB36.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="46" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>As you can see, IDA didn&apos;t really like it.</text:p><text:p/><text:p>hopefully, it&apos;s been fixed since. (the IDA guys always fix such bug the same day)</text:p><text:p/><text:p>So, if CoST helps you to find a few bugs in your program, I&apos;m not really surprised.</text:p><text:p/><text:p>Feel free to send me a postcard if it did.</text:p><text:p>or a red cross t-shirt from your country ;)</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page47" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL4T32"><draw:frame presentation:style-name="pr17" draw:layer="layout" svg:width="24.299cm" svg:height="15.373cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="subtitle"><draw:text-box><text:p>a bit more of PE...</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="47" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>but one single file, even full of tricks, is not enough to express all the possibilities of the PE file.</text:p><text:p/><text:p>so I started my next project since I applied for Hashdays</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page48" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>PE on corkami</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>some graphs</text:p></text:list-item><text:list-item><text:p>a wiki page</text:p><text:list><text:list-item><text:p><text:a xlink:href="http://pe.corkami.com/">http://pe.corkami.com</text:a></text:p></text:list-item><text:list-item><text:p>not “finished”</text:p></text:list-item><text:list-item><text:p>more than 100 PoCs</text:p></text:list-item><text:list-item><text:p>good enough to break &lt;you name it&gt;</text:p></text:list-item></text:list><text:p/></text:list-item></text:list></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="48" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>I already made some useful graphs for PE files.</text:p><text:p/><text:p>and I started a wiki page, with more than 100 PoCs, focusing, as usual, on precise aspects of the PE.</text:p><text:p/><text:p>PE with no section, with 64k sections, with huge Imagebase, relocation encryption...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page49" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL3T19"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>virtual section table vs Hiew 8.15</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="25.736cm" svg:height="13.335cm" svg:x="0.635cm" svg:y="3.81cm"><draw:image xlink:href="Pictures/10000000000003F0000002203D246F19.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="49" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>in low alignments, the section table is checked but not used at all.</text:p><text:p>so, if it&apos;s full of zeroes, it will still work – under XP.</text:p><text:p/><text:p>thus, with SizeOfOptionalHeader, you can set it in virtual space...</text:p><text:p/><text:p>Hiew doesn&apos;t like that.</text:p><text:p>check the picture, it doesn&apos;t even identify it as a PE.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page50" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>Folded header vs Hiew</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="18.491cm" svg:height="13.259cm" svg:x="4.255cm" svg:y="3.886cm"><draw:image xlink:href="Pictures/10000000000001A10000012BE9C62F2D.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="50" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>what do you think ?</text:p><text:p/><text:p>when you can do ASCII art with the PE info, something dodgy is going on :)</text:p><text:p/><text:p>this is reversinglabs&apos; dual PE header.</text:p><text:p>the PE header is partially overwritten (at exports directories) on loading. </text:p><text:p/><text:p>the upper part is read from disk, the lower part, read in memory, is overwritten by the section that is folded over the bottom of the header.</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page51" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p>Weird export names</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>exports = &lt;anything non null&gt;, 0</text:p></text:list-item></text:list></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="24.386cm" svg:height="6.985cm" svg:x="1.308cm" svg:y="7.508cm"><draw:image xlink:href="Pictures/1000000000000239000000A3416361BF.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="51" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>export names can be anything until 0, or even null.</text:p><text:p/><text:p>Hiew displays them inline, so, well, here is the PoC of weird export names</text:p><text:p/><text:p>one of the other names in this PoC is LOOOONG enough to trigger a buffer overflow &gt;:)</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page52" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr11" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>65535 sections vs OllyDbg (2.01a4)</text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr12" draw:text-style-name="P2" draw:layer="layout" svg:width="24.299cm" svg:height="9.14cm" svg:x="1.349cm" svg:y="5.581cm" presentation:class="graphic"><draw:image xlink:href="Pictures/100000000000013700000075B129B23B.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="52" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>this is a 64k section PE against the latest Olly.</text:p><text:p/><text:p>amazingly, it doesn&apos;t crash despite this funny message...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page53" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>one last...</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="12.638cm" svg:x="1.351cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>TLS AddressOfIndex is overwritten on loading</text:p></text:list-item><text:list-item><text:p>Import are parsed until Name is 0</text:p><text:p/></text:list-item><text:list-item><text:p>under XP, overwritten after imports</text:p><text:list><text:list-item><text:p>imports are fully parsed</text:p></text:list-item></text:list></text:list-item><text:list-item><text:p>under W7, before</text:p><text:list><text:list-item><text:p>truncated</text:p></text:list-item></text:list></text:list-item></text:list><text:p text:style-name="P2">same PE, working differently</text:p><text:p text:style-name="P2">with different versions</text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="53" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>this one is not very visual, yet quite unique.</text:p><text:p/><text:p>TLS AoI points to an Import descriptor Name member...</text:p><text:p/><text:p>depending on AoI or imports happening first, this is a terminator or not...</text:p><text:p/><text:p>so the same PE gets loaded with more or less imports depending on the OS.</text:p><text:p/></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page54" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>Conclusion</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="11.879cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>x86 and PE are far from perfectly logical</text:p></text:list-item><text:list-item><text:p>still some gray areas of PE or x86</text:p><text:list><text:list-item><text:p>but a bit less, every day</text:p></text:list-item></text:list><text:p/></text:list-item></text:list><text:p text:style-name="P2"><text:span text:style-name="T2">Following blindly the official documentation</text:span></text:p><text:p text:style-name="P2"><text:span text:style-name="T2">will only lead to</text:span></text:p><text:p text:style-name="P2"><text:span text:style-name="T25">FAILURE</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="54" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes"><draw:text-box><text:p>unlike what I used to believe, cpus and windows binaries are far from perfectly logical.</text:p><text:p/><text:p>I can&apos;t pretend I know it all, but I&apos;m progressing slowly, and fully sharing with everybody.</text:p><text:p/><text:p>If you only follow the official doc, you&apos;re bound to fail. especially with the malware landscape out there.</text:p><text:p/><text:p>most if not all the bugs you&apos;ve seen are already fixed, if not already released.</text:p><text:p/><text:p>I seriously hope that MS will put WinDbg back to a more reactive release cycle, and will update it...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page55" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL2T1"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="3.005cm" svg:x="1.35cm" svg:y="0.717cm" presentation:class="title"><draw:text-box><text:p>Thanks</text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr7" draw:layer="layout" svg:width="24.299cm" svg:height="12.59cm" svg:x="1.35cm" svg:y="4.212cm" presentation:class="outline" presentation:user-transformed="true"><draw:text-box><text:list text:style-name="L3"><text:list-item><text:p>Peter Ferrie</text:p></text:list-item><text:list-item><text:p>Candid Wüest</text:p><text:p><text:span text:style-name="T8"/></text:p></text:list-item></text:list><text:p><text:span text:style-name="T26">Adam Błasczcyk, BeatriX, Bruce Dang, Cathal Mullaney, Czerno, Elias Bachaalany, Eugeny Suslikov, Gil Dabah, Guillaume Delugré, Igor Skochinsky, Ilfak Guilfanov, Ivanlef0u, Jean-Baptiste Bédrune, j00ru, Jim Leonard, Jon Larimer, Moritz Kroll, Oleh Yuschuk, Sebastian Biallas, StalkR, Yoann Guillot,...</text:span></text:p><text:p><text:span text:style-name="T8"/></text:p><text:p text:style-name="P2"><text:span text:style-name="T27">Questions ?</text:span></text:p><text:p text:style-name="P2"><text:span text:style-name="T6"/></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="55" presentation:class="page"/><draw:frame presentation:style-name="pr8" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p>Eternal thanks to Peter Ferrie, my yoda. I feel he should be the one presenting this.</text:p><text:p/><text:p>Also, I wouldn&apos;t be here if Candid didn&apos;t push me and motivate me to.</text:p><text:p/><text:p>a lot of people helped me in the process to make this presentation and the content on corkami, in one way or another.</text:p><text:p/><text:p>Any questions ?</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><draw:page draw:name="page56" draw:style-name="dp1" draw:master-page-name="Default" presentation:presentation-page-layout-name="AL1T0"><draw:frame presentation:style-name="pr1" draw:layer="layout" svg:width="24.299cm" svg:height="4.259cm" svg:x="1.35cm" svg:y="5.39cm" presentation:class="title" presentation:user-transformed="true"><draw:text-box><text:p><text:span text:style-name="T1">Such a weird processor</text:span><text:line-break/><text:span text:style-name="T2">messing with opcodes</text:span><text:span text:style-name="T2"><text:line-break/></text:span><text:span text:style-name="T3">(...and a little bit of PE)</text:span></text:p></draw:text-box></draw:frame><draw:frame presentation:style-name="pr2" draw:text-style-name="P1" draw:layer="layout" svg:width="24.299cm" svg:height="4.661cm" svg:x="1.35cm" svg:y="11.43cm"><draw:text-box><text:p text:style-name="P12"><text:span text:style-name="T4">Ange Albertini</text:span></text:p><text:p text:style-name="P12"><text:span text:style-name="T4">28</text:span><text:span text:style-name="T5">th</text:span><text:span text:style-name="T4"> October 2011</text:span></text:p></draw:text-box></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="9.141cm" svg:height="3.395cm" svg:x="17.846cm" svg:y="14.605cm"><draw:image xlink:href="Pictures/10000201000001A40000009C5F0B4D9D.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr1" draw:text-style-name="P2" draw:layer="layout" svg:width="3.81cm" svg:height="3.81cm" svg:x="0cm" svg:y="14.19cm"><draw:image xlink:href="Pictures/1000020100000050000000502BC44F56.png" xlink:type="simple" xlink:show="embed" xlink:actuate="onLoad"><text:p/></draw:image></draw:frame><draw:frame draw:style-name="gr2" draw:text-style-name="P13" draw:layer="layout" svg:width="6.111cm" svg:height="1.471cm" svg:x="4.184cm" svg:y="15.699cm"><draw:text-box><text:p text:style-name="P13"><text:span text:style-name="T6">@ange4771</text:span></text:p><text:p text:style-name="P13"><text:span text:style-name="T6">@corkami</text:span><text:span text:style-name="T7"> (news only)</text:span></text:p></draw:text-box></draw:frame><presentation:notes draw:style-name="dp2"><draw:page-thumbnail draw:style-name="gr3" draw:layer="layout" svg:width="13.968cm" svg:height="10.476cm" svg:x="3.81cm" svg:y="2.123cm" draw:page-number="56" presentation:class="page"/><draw:frame presentation:style-name="pr3" draw:text-style-name="P4" draw:layer="layout" svg:width="17.271cm" svg:height="12.572cm" svg:x="2.159cm" svg:y="13.271cm" presentation:class="notes" presentation:user-transformed="true"><draw:text-box><text:p text:style-name="P4">Thanks for your attention!</text:p><text:p text:style-name="P4"/><text:p text:style-name="P4">you can catch me online</text:p><text:p text:style-name="P4"/><text:p text:style-name="P4">I&apos;m open to suggestions, feedback, requests...</text:p></draw:text-box></draw:frame></presentation:notes></draw:page><presentation:settings presentation:mouse-visible="false"/></office:presentation></office:body></office:document-content>